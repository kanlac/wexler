# Mindful è½¯é“¾æ¥æ¶æ„é‡è®¾è®¡æ–¹æ¡ˆ

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0
**åˆ›å»ºæ—¥æœŸ**: 2025-09-26
**é‡å¤§æ¶æ„è½¬å‹**: ä»å¤æ‚çš„å†…å®¹ç”Ÿæˆè½¬å‘æç®€çš„è½¯é“¾æ¥å¼•ç”¨

## ğŸš€ æ¶æ„é©æ–°çš„æ ¸å¿ƒæ´å¯Ÿ

### æ ¹æœ¬æ€§å‘ç°
**ä¼ ç»Ÿæ–¹æ¡ˆçš„å¤æ‚åº¦æ¥æº**: ä¸ºä¸åŒå·¥å…·ç”Ÿæˆ"æœ¬è´¨ç›¸åŒä½†æ ¼å¼ç•¥å¼‚"çš„é…ç½®æ–‡ä»¶
**è½¯é“¾æ¥æ–¹æ¡ˆçš„æ ¸å¿ƒ**: æ“ä½œç³»ç»Ÿå±‚é¢çš„æ–‡ä»¶å¼•ç”¨æœºåˆ¶ï¼Œä¸€ä»½å†…å®¹ï¼Œå¤šä¸ªè®¿é—®è·¯å¾„

### æ¶æ„è½¬å‹å¯¹æ¯”

| ç»´åº¦ | ä¼ ç»Ÿå†…å®¹ç”Ÿæˆæ–¹æ¡ˆ | è½¯é“¾æ¥å¼•ç”¨æ–¹æ¡ˆ |
|------|------------------|----------------|
| **æ ¸å¿ƒæµç¨‹** | Source â†’ Parse â†’ Generate â†’ Write | Source â†’ Create Symlinks |
| **ä»£ç å¤æ‚åº¦** | ~3000 è¡Œä»£ç  | ~800 è¡Œä»£ç  (-70%) |
| **è¿è¡Œæ—¶æ€§èƒ½** | O(N*M) è§£æè½¬æ¢ | O(N) è½¯é“¾æ¥åˆ›å»º |
| **æ¦‚å¿µå¤æ‚åº¦** | é€‚é…å™¨+ç”Ÿæˆå™¨+æå–å™¨ | è½¯é“¾æ¥æ˜ å°„è¡¨ |
| **ç»´æŠ¤æˆæœ¬** | æ¯ä¸ªå·¥å…·éœ€è¦ç‹¬ç«‹é€‚é…å™¨ | é…ç½®æ˜ å°„è¡¨ç»´æŠ¤ |
| **æ‰©å±•æ€§** | æ–°å·¥å…·éœ€è¦ç¼–ç¨‹å®ç° | æ–°å·¥å…·åªéœ€é…ç½®æ˜ å°„ |

## ğŸ“ å…¨æ–°çš„é¡¹ç›®æ–‡ä»¶ç»“æ„

### æ•°æ®æºç»“æ„ (å•ä¸€äº‹å®æº)
```
é¡¹ç›®æ ¹ç›®å½•/
â”œâ”€â”€ mindful.yaml              # é¡¹ç›®é…ç½® + è½¯é“¾æ¥æ˜ å°„
â”œâ”€â”€ MINDFUL.md               # ç»Ÿä¸€é•¿æœŸè®°å¿†æ–‡ä»¶
â”œâ”€â”€ subagents/               # å­ä»£ç†é…ç½®ç›®å½•
â”‚   â”œâ”€â”€ researcher.md
â”‚   â”œâ”€â”€ reviewer.md
â”‚   â””â”€â”€ planner.md
â”œâ”€â”€ .mcp.json               # MCPé…ç½®æ–‡ä»¶
â””â”€â”€ mindful/                # é¡¹ç›®çº§é…ç½® (å¦‚æœå­˜åœ¨)
    â”œâ”€â”€ memory.mdc          # é¡¹ç›®ç‰¹å®šè®°å¿†
    â””â”€â”€ subagents/          # é¡¹ç›®ç‰¹å®šå­ä»£ç†
```

### å·¥å…·è½¯é“¾æ¥ç»“æ„ (å¼•ç”¨å±‚)
```
é¡¹ç›®æ ¹ç›®å½•/
â”œâ”€â”€ CLAUDE.md               -> MINDFUL.md
â”œâ”€â”€ AGENTS.md               -> MINDFUL.md
â”œâ”€â”€ .cursor/
â”‚   â”œâ”€â”€ rules/
â”‚   â”‚   â”œâ”€â”€ general.mindful.mdc -> ../../MINDFUL.md
â”‚   â”‚   â”œâ”€â”€ researcher.mindful.mdc -> ../../subagents/researcher.md
â”‚   â”‚   â””â”€â”€ reviewer.mindful.mdc -> ../../subagents/reviewer.md
â”‚   â””â”€â”€ mcp.json           -> ../.mcp.json
â”œâ”€â”€ .claude/
â”‚   â”œâ”€â”€ agents/
â”‚   â”‚   â”œâ”€â”€ researcher.mindful.md -> ../../subagents/researcher.md
â”‚   â”‚   â””â”€â”€ reviewer.mindful.md -> ../../subagents/reviewer.md
â”‚   â””â”€â”€ .mcp.json         -> ../.mcp.json
â””â”€â”€ .gemini/
    â”œâ”€â”€ context.md         -> MINDFUL.md
    â””â”€â”€ agents/            -> subagents/ (ç›®å½•è½¯é“¾æ¥)
```

## ğŸ—ï¸ æç®€åŒ–çš„ä»£ç æ¶æ„

### æ–°çš„æ ¸å¿ƒæ¨¡å—ç»“æ„
```
src/
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ config.go          # é¡¹ç›®é…ç½® + è½¯é“¾æ¥æ˜ å°„é…ç½®
â”‚   â”œâ”€â”€ source.go          # æºæ–‡ä»¶é…ç½® (ç®€åŒ–)
â”‚   â””â”€â”€ symlink.go         # è½¯é“¾æ¥é…ç½®æ¨¡å‹
â”œâ”€â”€ config/
â”‚   â””â”€â”€ manager.go         # é¡¹ç›®é…ç½®ç®¡ç†
â”œâ”€â”€ source/
â”‚   â”œâ”€â”€ manager.go         # æºé…ç½®è§£æ (ç®€åŒ–)
â”‚   â””â”€â”€ parser.go          # æ ‡è®°è§£æ (ä¿ç•™)
â”œâ”€â”€ storage/
â”‚   â””â”€â”€ manager.go         # MCP é…ç½®å­˜å‚¨ (ä¿ç•™)
â”œâ”€â”€ symlink/               # ğŸ†• è½¯é“¾æ¥ç®¡ç†æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ manager.go         # è½¯é“¾æ¥åˆ›å»º/æ›´æ–°/æ¸…ç†
â”‚   â”œâ”€â”€ config.go          # å·¥å…·è½¯é“¾æ¥é…ç½®
â”‚   â””â”€â”€ resolver.go        # è·¯å¾„è§£æå’ŒéªŒè¯
â””â”€â”€ cli/
    â”œâ”€â”€ init.go            # åˆå§‹åŒ– (ç®€åŒ–)
    â”œâ”€â”€ apply.go           # ğŸ”„ é‡å†™ä¸ºè½¯é“¾æ¥ç®¡ç†
    â”œâ”€â”€ list.go            # åˆ—å‡ºé…ç½® (ç®€åŒ–)
    â””â”€â”€ import.go          # å¯¼å…¥é…ç½® (ç®€åŒ–)
```

### åˆ é™¤çš„æ¨¡å— (å¤§å¹…ç®€åŒ–)
```
ğŸ—‘ï¸ å®Œå…¨åˆ é™¤çš„ç›®å½•å’Œæ–‡ä»¶:
â”œâ”€â”€ src/tools/             # æ•´ä¸ªå·¥å…·é€‚é…å™¨ç›®å½•
â”‚   â”œâ”€â”€ claude/
â”‚   â”œâ”€â”€ cursor/
â”‚   â”œâ”€â”€ adapter.go
â”‚   â””â”€â”€ types/
â”œâ”€â”€ src/apply/
â”‚   â”œâ”€â”€ content_extractor.go  # å†…å®¹æå–å™¨
â”‚   â””â”€â”€ manager.go (éƒ¨åˆ†é€»è¾‘) # å¤æ‚çš„åº”ç”¨ç®¡ç†é€»è¾‘
â””â”€â”€ tests/
    â””â”€â”€ ç›¸å…³çš„é€‚é…å™¨æµ‹è¯•æ–‡ä»¶
```

## ğŸ¯ è½¯é“¾æ¥é…ç½®æ–¹æ¡ˆ

### mindful.yaml é…ç½®æ ¼å¼æ‰©å±•
```yaml
# åŸºç¡€é¡¹ç›®é…ç½®
name: "my-project"
version: "1.0.0"
source: "/path/to/team-configs"

# å·¥å…·å¯ç”¨é…ç½®
tools:
  claude: "enabled"
  cursor: "enabled"
  gemini: "enabled"

# ğŸ†• è½¯é“¾æ¥æ˜ å°„é…ç½®
symlinks:
  claude:
    memory: "CLAUDE.md"                    # -> MINDFUL.md
    subagents: ".claude/agents/{name}.mindful.md"  # -> subagents/{name}.md
    mcp: ".claude/.mcp.json"               # -> .mcp.json

  cursor:
    memory: ".cursor/rules/general.mindful.mdc"    # -> MINDFUL.md
    subagents: ".cursor/rules/{name}.mindful.mdc"  # -> subagents/{name}.md
    mcp: ".cursor/mcp.json"                        # -> .mcp.json

  gemini:
    memory: ".gemini/context.md"           # -> MINDFUL.md
    subagents: ".gemini/agents/"           # -> subagents/ (ç›®å½•é“¾æ¥)
    mcp: ".gemini/.mcp.json"               # -> .mcp.json

  # ğŸ†• è‡ªå®šä¹‰å·¥å…·æ”¯æŒ
  custom_tool:
    memory: "custom/path/MEMORY.md"        # -> MINDFUL.md
    subagents: "custom/agents/{name}.md"   # -> subagents/{name}.md
    mcp: "custom/.mcp.json"                # -> .mcp.json
```

### è½¯é“¾æ¥ç®¡ç†å™¨æ¥å£è®¾è®¡
```go
// src/symlink/manager.go
type Manager struct {
    projectPath string
    config     *models.SymlinkConfig
}

func NewManager(projectPath string, config *models.SymlinkConfig) *Manager

func (m *Manager) CreateSymlinks(toolName string) error
func (m *Manager) UpdateSymlinks(toolName string) error
func (m *Manager) CleanupSymlinks(toolName string) error
func (m *Manager) ValidateSymlinks(toolName string) error
func (m *Manager) ListSymlinks(toolName string) ([]SymlinkInfo, error)

type SymlinkInfo struct {
    LinkPath   string
    TargetPath string
    IsValid    bool
    IsDirectory bool
}
```

## ğŸš€ æ–°çš„ mindful apply å·¥ä½œæµç¨‹

### æç®€åŒ–çš„æ‰§è¡Œé€»è¾‘
```go
func runApply(cmd *cobra.Command, args []string) error {
    // ğŸ¯ 4æ­¥æç®€æµç¨‹
    ctx := loadApplyContext(cmd, args)           // 1. åŠ è½½ä¸Šä¸‹æ–‡
    sourceConfig := loadSourceConfiguration(ctx)  // 2. åŠ è½½æºé…ç½®
    enabledTools := determineEnabledTools(ctx)   // 3. ç¡®å®šç›®æ ‡å·¥å…·

    return executeSymlinkCreation(ctx, enabledTools) // 4. åˆ›å»ºè½¯é“¾æ¥
}

func executeSymlinkCreation(ctx *ApplyContext, tools []string) error {
    symlinkManager := symlink.NewManager(ctx.ProjectPath, ctx.SymlinkConfig)
    results := make([]ToolResult, len(tools))

    for i, toolName := range tools {
        result := ToolResult{Tool: toolName}

        if ctx.DryRun {
            // å¹²è¿è¡Œ: åªæ˜¾ç¤ºå°†è¦åˆ›å»ºçš„è½¯é“¾æ¥
            links, err := symlinkManager.PlanSymlinks(toolName)
            result.PlannedLinks = links
            result.Error = err
        } else {
            // å®é™…æ‰§è¡Œ: åˆ›å»ºè½¯é“¾æ¥
            err := symlinkManager.CreateSymlinks(toolName)
            result.Error = err
        }

        results[i] = result
    }

    return reportResults(ctx, results)
}
```

## ğŸ”§ å®æ–½é˜¶æ®µè§„åˆ’

### é˜¶æ®µ 1: è½¯é“¾æ¥æ ¸å¿ƒæ¨¡å— (1.5å°æ—¶)

#### 1.1 åŸºç¡€è®¾æ–½åˆ›å»º
- åˆ›å»º `src/symlink/` åŒ…
- å®ç° `Manager` ç»“æ„ä½“å’Œæ ¸å¿ƒæ–¹æ³•
- å®ç°è½¯é“¾æ¥é…ç½®è§£æé€»è¾‘
- æ·»åŠ è·¯å¾„éªŒè¯å’Œå†²çªæ£€æµ‹

#### 1.2 é…ç½®æ ¼å¼æ‰©å±•
- æ‰©å±• `mindful.yaml` æ”¯æŒè½¯é“¾æ¥æ˜ å°„
- æ›´æ–° `src/models/config.go` æ·»åŠ è½¯é“¾æ¥é…ç½®ç»“æ„
- å®ç°å‘åå…¼å®¹æ€§å¤„ç†

### é˜¶æ®µ 2: CLI å‘½ä»¤é‡å†™ (1å°æ—¶)

#### 2.1 apply å‘½ä»¤é‡å†™
- é‡å†™ `runApply()` ä¸º4æ­¥æç®€æµç¨‹
- å®ç°è½¯é“¾æ¥åˆ›å»ºçš„é”™è¯¯å¤„ç† (è·³è¿‡å¤±è´¥ç»§ç»­)
- è®¾è®¡æ”¹è¿›çš„ç”¨æˆ·è¾“å‡ºæ ¼å¼

#### 2.2 å…¶ä»–å‘½ä»¤ç®€åŒ–
- ç®€åŒ– `list` å‘½ä»¤æ˜¾ç¤ºè½¯é“¾æ¥çŠ¶æ€
- æ›´æ–° `init` å‘½ä»¤ç”Ÿæˆè½¯é“¾æ¥é…ç½®æ¨¡æ¿
- ä¿æŒ `import` å‘½ä»¤åŸºæœ¬ä¸å˜

### é˜¶æ®µ 3: å¤§è§„æ¨¡ä»£ç åˆ é™¤ (0.5å°æ—¶)

#### 3.1 æ¨¡å—åˆ é™¤
- åˆ é™¤æ•´ä¸ª `src/tools/` ç›®å½•
- åˆ é™¤ `src/apply/content_extractor.go`
- æ¸…ç† `src/apply/manager.go` ä¸­çš„å¤æ‚é€»è¾‘

#### 3.2 ä¾èµ–æ¸…ç†
- æ›´æ–°æ‰€æœ‰ import è¯­å¥
- åˆ é™¤æ— ç”¨çš„ä¾èµ–å’Œæµ‹è¯•æ–‡ä»¶
- ç®€åŒ–æ¨¡å‹ç»“æ„ä½“å®šä¹‰

### é˜¶æ®µ 4: æµ‹è¯•å’Œä¼˜åŒ– (1å°æ—¶)

#### 4.1 è½¯é“¾æ¥æµ‹è¯•
- ç¼–å†™è½¯é“¾æ¥åˆ›å»º/æ›´æ–°/æ¸…ç†çš„æµ‹è¯•
- æµ‹è¯•è·¨å¹³å°å…¼å®¹æ€§ (Windows/Linux/Mac)
- éªŒè¯ç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„å¤„ç†

#### 4.2 ç”¨æˆ·ä½“éªŒä¼˜åŒ–
- æ”¹è¿›è¿›åº¦æŒ‡ç¤ºå’ŒæˆåŠŸ/å¤±è´¥ä¿¡æ¯
- æ·»åŠ è½¯é“¾æ¥çŠ¶æ€æ£€æŸ¥å’Œä¿®å¤åŠŸèƒ½
- ä¼˜åŒ–å¹²è¿è¡Œæ¨¡å¼çš„ä¿¡æ¯å±•ç¤º

## ğŸ“Š é¢„æœŸæ•ˆæœè¯„ä¼°

### æ€§èƒ½æå‡
- **å¯åŠ¨æ—¶é—´**: ä»ç§’çº§é™è‡³æ¯«ç§’çº§
- **å†…å­˜ä½¿ç”¨**: å‡å°‘70% (æ— éœ€åŠ è½½å¤šä¸ªé€‚é…å™¨)
- **ç£ç›˜ä½¿ç”¨**: å‡å°‘é‡å¤æ–‡ä»¶å­˜å‚¨

### å¼€å‘ä½“éªŒ
- **ä»£ç è¡Œæ•°**: å‡å°‘70% (ä»~3000è¡Œåˆ°~800è¡Œ)
- **æ¦‚å¿µå¤æ‚åº¦**: æ˜¾è‘—é™ä½ (æ— éœ€ç†è§£é€‚é…å™¨æ¨¡å¼)
- **è°ƒè¯•éš¾åº¦**: å¤§å¹…é™ä½ (è½¯é“¾æ¥çŠ¶æ€ç›´è§‚å¯è§)

### ç”¨æˆ·ä½“éªŒ
- **æ‰§è¡Œé€Ÿåº¦**: æ¯«ç§’çº§å“åº”
- **é…ç½®ä¸€è‡´æ€§**: çœŸæ­£çš„å•ä¸€æ•°æ®æº
- **å·¥å…·å…¼å®¹**: æ”¯æŒä»»æ„å·¥å…·çš„è‡ªå®šä¹‰è·¯å¾„é…ç½®

### æ‰©å±•æ€§
- **æ–°å·¥å…·æ”¯æŒ**: ä»…éœ€é…ç½®è½¯é“¾æ¥æ˜ å°„ï¼Œæ— éœ€ç¼–ç¨‹
- **è‡ªå®šä¹‰è·¯å¾„**: å®Œå…¨æ”¯æŒå·¥å…·ç‰¹å®šçš„æ–‡ä»¶è·¯å¾„éœ€æ±‚
- **å›¢é˜Ÿé…ç½®**: è½¯é“¾æ¥é…ç½®å¯ç‰ˆæœ¬æ§åˆ¶å’Œå…±äº«

## âš ï¸ å®æ–½é£é™©å’Œç¼“è§£ç­–ç•¥

### æŠ€æœ¯é£é™©

#### R1: è·¨å¹³å°å…¼å®¹æ€§ - **ä¸­ç­‰**
**é£é™©**: Windows å¯¹è½¯é“¾æ¥çš„æ”¯æŒä¸åŒäº Unix ç³»ç»Ÿ
**ç¼“è§£**:
- ä½¿ç”¨ Go çš„ `os.Symlink()` API å¤„ç†è·¨å¹³å°å·®å¼‚
- Windows ä¸‹è‡ªåŠ¨æ£€æµ‹ç®¡ç†å‘˜æƒé™ï¼Œæä¾›å‹å¥½æç¤º
- æä¾› hardlink å¤‡é€‰æ–¹æ¡ˆç”¨äºä¸æ”¯æŒè½¯é“¾æ¥çš„ç¯å¢ƒ

#### R2: ç°æœ‰é¡¹ç›®è¿ç§» - **ä½**
**é£é™©**: ç°æœ‰ç”¨æˆ·çš„é¡¹ç›®è¿ç§»å¤æ‚
**ç¼“è§£**:
- å®ç°è‡ªåŠ¨è¿ç§»å·¥å…·æ£€æµ‹ç°æœ‰æ–‡ä»¶ç»“æ„
- æä¾›å‘åå…¼å®¹æ¨¡å¼æ”¯æŒæ¸è¿›è¿ç§»
- è¯¦ç»†çš„è¿ç§»æŒ‡å—å’Œå·¥å…·

### ç”¨æˆ·ä½“éªŒé£é™©

#### R3: è½¯é“¾æ¥æ¦‚å¿µç†è§£ - **ä½**
**é£é™©**: ç”¨æˆ·ä¸ç†è§£è½¯é“¾æ¥æ¦‚å¿µ
**ç¼“è§£**:
- æä¾›æ¸…æ™°çš„è½¯é“¾æ¥çŠ¶æ€æ˜¾ç¤º
- å®ç° `mindful status` å‘½ä»¤æ˜¾ç¤ºé“¾æ¥å¥åº·åº¦
- æ–‡æ¡£ä¸­æä¾›è½¯é“¾æ¥åŸºç¡€çŸ¥è¯†è¯´æ˜

## ğŸ¯ æˆåŠŸéªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶
- âœ… æ”¯æŒè‡³å°‘3ä¸ªä¸»æµå·¥å…· (Claude Code, Cursor, Gemini)
- âœ… è½¯é“¾æ¥åˆ›å»º/æ›´æ–°/æ¸…ç†åŠŸèƒ½å®Œæ•´
- âœ… è·¨å¹³å°å…¼å®¹æ€§éªŒè¯é€šè¿‡
- âœ… ç°æœ‰é¡¹ç›®è‡ªåŠ¨è¿ç§»æˆåŠŸ

### æ€§èƒ½éªŒæ”¶
- âœ… `mindful apply` æ‰§è¡Œæ—¶é—´ < 100ms (vs å½“å‰ 1-2s)
- âœ… ä»£ç è¡Œæ•°å‡å°‘ > 60%
- âœ… å†…å­˜å ç”¨å‡å°‘ > 50%

### ç”¨æˆ·ä½“éªŒéªŒæ”¶
- âœ… 5åˆ†é’Ÿå†…å®Œæˆæ–°é¡¹ç›®é…ç½®
- âœ… ç¼–è¾‘ä¸€æ¬¡é…ç½®ï¼Œæ‰€æœ‰å·¥å…·åŒæ­¥æ›´æ–°
- âœ… æ¸…æ™°çš„è½¯é“¾æ¥çŠ¶æ€åé¦ˆ

---

## æ€»ç»“

è½¯é“¾æ¥ç­–ç•¥ä»£è¡¨äº†ä»"å¤æ‚çš„å†…å®¹å¤åˆ¶"åˆ°"ç®€å•çš„å¼•ç”¨æ˜ å°„"çš„æ ¹æœ¬æ€§æ¶æ„è½¬å˜ã€‚è¿™ä¸ä»…ä»…æ˜¯é‡æ„ï¼Œè€Œæ˜¯é‡æ–°å‘æ˜äº†ä¸€ä¸ªæ›´ä¼˜é›…ã€æ›´é«˜æ•ˆã€æ›´æ˜“ç»´æŠ¤çš„è§£å†³æ–¹æ¡ˆã€‚

é€šè¿‡åˆ©ç”¨æ“ä½œç³»ç»Ÿå±‚é¢çš„è½¯é“¾æ¥æœºåˆ¶ï¼Œæˆ‘ä»¬å°†ä¸€ä¸ªå¤æ‚çš„å¤šå·¥å…·é…ç½®åŒæ­¥é—®é¢˜ï¼Œè½¬åŒ–ä¸ºä¸€ä¸ªç®€å•çš„æ–‡ä»¶ç³»ç»Ÿå¼•ç”¨é—®é¢˜ã€‚è¿™æ˜¯å…¸å‹çš„"ç«™åœ¨å·¨äººè‚©è†€ä¸Š"çš„å·¥ç¨‹æ™ºæ…§ä½“ç°ã€‚